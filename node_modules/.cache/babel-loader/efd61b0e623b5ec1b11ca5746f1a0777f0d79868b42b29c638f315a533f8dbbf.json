{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[errorMessage,setErrorMessage]=useState('');const[loading,setLoading]=useState(false);const navigate=useNavigate();const handleSubmit=async e=>{e.preventDefault();if(!email||!password){setErrorMessage('Por favor, rellena todos los campos');return;}const loginData={email,password};setLoading(true);try{const response=await fetch('http://localhost:3000/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(loginData)});const data=await response.json();console.log('Login response:',data);// Para depuración\nif(response.ok){setErrorMessage('');localStorage.setItem('token',data.token);localStorage.setItem('userId',data.userId);localStorage.setItem('userName',data.userName||data.name);localStorage.setItem('userRole',data.role);// Verificar que se guardó correctamente\nconsole.log('Stored in localStorage:',{token:localStorage.getItem('token'),userId:localStorage.getItem('userId'),userName:localStorage.getItem('userName'),userRole:localStorage.getItem('userRole')});navigate('/menu');}else{setErrorMessage(data.message||'Correo o contraseña incorrectos');}}catch(error){console.error('Error al conectar con el servidor:',error);setErrorMessage('Error al conectar con el servidor. Por favor, inténtalo de nuevo más tarde.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Iniciar Sesi\\xF3n\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Correo Electr\\xF3nico\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?'Iniciando sesión...':'Ingresar'})]}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:errorMessage})]}),/*#__PURE__*/_jsx(\"div\",{className:\"debug-info\"})]});};export default Login;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Login","email","setEmail","password","setPassword","errorMessage","setErrorMessage","loading","setLoading","navigate","handleSubmit","e","preventDefault","loginData","response","fetch","method","headers","body","JSON","stringify","data","json","console","log","ok","localStorage","setItem","token","userId","userName","name","role","getItem","userRole","message","error","className","children","onSubmit","htmlFor","type","id","value","onChange","target","required","disabled"],"sources":["C:/Users/Francisco Chong/Desktop/Proyecto Final/Front-UACJ-Repos/src/components/Login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Login = () => {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        if (!email || !password) {\r\n            setErrorMessage('Por favor, rellena todos los campos');\r\n            return;\r\n        }\r\n        const loginData = { email, password };\r\n        setLoading(true);\r\n    \r\n        try {\r\n            const response = await fetch('http://localhost:3000/api/login', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify(loginData),\r\n            });\r\n            const data = await response.json();\r\n            console.log('Login response:', data);  // Para depuración\r\n\r\n            if (response.ok) {\r\n                setErrorMessage('');\r\n                localStorage.setItem('token', data.token);\r\n                localStorage.setItem('userId', data.userId);\r\n                localStorage.setItem('userName', data.userName || data.name);\r\n                localStorage.setItem('userRole', data.role);\r\n\r\n                // Verificar que se guardó correctamente\r\n                console.log('Stored in localStorage:', {\r\n                    token: localStorage.getItem('token'),\r\n                    userId: localStorage.getItem('userId'),\r\n                    userName: localStorage.getItem('userName'),\r\n                    userRole: localStorage.getItem('userRole')\r\n                });\r\n\r\n                navigate('/menu');\r\n            } else {\r\n                setErrorMessage(data.message || 'Correo o contraseña incorrectos');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error al conectar con el servidor:', error);\r\n            setErrorMessage('Error al conectar con el servidor. Por favor, inténtalo de nuevo más tarde.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"login-container\">\r\n                <h2>Iniciar Sesión</h2>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"input-group\">\r\n                        <label htmlFor=\"email\">Correo Electrónico</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            id=\"email\"\r\n                            value={email}\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"input-group\">\r\n                        <label htmlFor=\"password\">Contraseña</label>\r\n                        <input\r\n                            type=\"password\"\r\n                            id=\"password\"\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <button type=\"submit\" disabled={loading}>\r\n                        {loading ? 'Iniciando sesión...' : 'Ingresar'}\r\n                    </button>\r\n                </form>\r\n                {errorMessage && <p className=\"error\">{errorMessage}</p>}\r\n            </div>\r\n            <div className=\"debug-info\">\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}